
import pyodbc
import pandas as pd
import warnings
import json

# Suppress UserWarnings from pandas
warnings.filterwarnings("ignore", category=UserWarning)

# Load configuration from config.json
with open('config.json', 'r') as file:
    config = json.load(file)

# Get settings from the JSON file
db_file = config['database']['db_file']
table_name = config['table']['table_name']
csv_file_path = config['output']['csv_file_path']

# Set up the connection to the Access database
conn_str = (
    r'DRIVER={Microsoft Access Driver (*.mdb, *.accdb)};'
    r'DBQ=' + db_file + ';'
)

# Connect to the Access database
conn = pyodbc.connect(conn_str)

# Query the table
query = f"SELECT * FROM {table_name}"

# Read the query results into a pandas DataFrame
df = pd.read_sql(query, conn)

# Save the DataFrame as a CSV file
df.to_csv(csv_file_path, index=False)

# Close the connection
conn.close()

print(f"Table {table_name} has been successfully exported to {csv_file_path}")
